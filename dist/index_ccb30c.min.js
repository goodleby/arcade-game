/**!
 * @link https://github.com/goodleby/arcade-game
 */
(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{tjUo:function(e,t,n){"use strict";n.r(t);var r={};n.r(r),n.d(r,"water",(function(){return i})),n.d(r,"stone",(function(){return o})),n.d(r,"grass",(function(){return s})),n.d(r,"player",(function(){return a})),n.d(r,"enemy",(function(){return c})),n.d(r,"heart",(function(){return u}));var i=n.p+"9dc4aee4bd2dc6681d77fd12642410ae.png",o=n.p+"326950c8c569d23ad642691175add517.png",s=n.p+"2912f72496e7f667402bd877b579973f.png",a=n.p+"edb65cb0ce11f504ec5165f59d3fec0a.png",c=n.p+"353c8adade719a7aecbfe9c522649682.png",u=n.p+"b4a0912d3d87c3df666a65fde3526c75.png";function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var p=function(e){return Promise.all(e.map((function(e){return t=e,new Promise((function(e,n){var r=new Image;r.src=t,r.onload=function(){return e(r)},r.onerror=function(e){return n(e)}}));var t})))},f=function e(t,n){return void 0===n?e(0,t-1):Math.floor(Math.random()*(n-t+1)+t)},y=function e(t,n){return void 0===n?e(1,t):Math.floor(Math.random()*n)>=n-t};function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.map,r=t.width;this.map=n.map((function(e,t){return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){b(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({y:t},e)})),this.height=n.length,this.width=r}var t,n,r;return t=e,(n=[{key:"renderLine",value:function(e,t,n){for(var r=0;r<this.width;r++)e.drawImage(t,101*r,80*n)}},{key:"render",value:function(e,t){var n=this;this.map.forEach((function(r,i){return n.renderLine(t,e[r.type],i)}))}},{key:"getSpawnY",value:function(){var e=this.map.filter((function(e){return e.spawn}));return e[f(e.length)].y}},{key:"getSpawnX",value:function(){return f(0,this.width-1)}},{key:"getSpawnPos",value:function(){return{x:this.getSpawnX(),y:this.getSpawnY()}}}])&&m(t.prototype,n),r&&m(t,r),e}();function w(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var g=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var n=t.position,r=n.x,i=n.y,o=t.hp;this.x=r,this.y=i,this.hp=o}var t,n,r;return t=e,(n=[{key:"render",value:function(e,t){t.drawImage(e,101*this.x,80*this.y-20)}},{key:"move",value:function(e){switch(e){case"left":this.x--;break;case"up":this.y--;break;case"right":this.x++;break;case"down":this.y++}}},{key:"moveLeft",value:function(){this.move("left")}},{key:"moveUp",value:function(){this.move("up")}},{key:"moveRight",value:function(){this.move("right")}},{key:"moveDown",value:function(){this.move("down")}},{key:"setPos",value:function(e){var t=e.x,n=e.y;this.x=t,this.y=n}},{key:"collapse",value:function(e){this.setPos(e),this.hp--}},{key:"heal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.hp+=e}}])&&w(t.prototype,n),r&&w(t,r),e}();function O(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var k=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=-1,this.y=t,this.speed=n}var t,n,r;return t=e,(n=[{key:"move",value:function(){this.x+=this.speed}},{key:"render",value:function(e,t){this.move(),t.drawImage(e,101*this.x,80*this.y-20)}}])&&O(t.prototype,n),r&&O(t,r),e}();function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D=function(e){function t(e,n,r){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),E(this,S(t).call(this,e,n,r,"heart"))}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,e),n=t,(r=[{key:"pickUp",value:function(e){e.player.heal(1),this.unavailable()}}])&&x(n.prototype,r),i&&x(n,i),t}(function(){function e(t,n,r,i){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.x=t,this.y=n,this.duration=r,this.imgTag=i,this.available=!0,setTimeout((function(){o.unavailable()}),this.duration)}var t,n,r;return t=e,(n=[{key:"unavailable",value:function(){this.available=!1}},{key:"render",value:function(e,t){t.drawImage(e,101*this.x,80*this.y-20)}}])&&P(t.prototype,n),r&&P(t,r),e}());function F(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?F(Object(n),!0).forEach((function(t){U(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):F(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var L,M=(L=r,new Promise((function(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){h(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},L);p(Object.values(n)).then((function(t){Object.keys(n).forEach((function(e,r){return n[e]=t[r]})),e(n)}))}))),A={player:{position:{x:3,y:5},hp:3},level:{map:[{type:"water",spawn:!1},{type:"stone",spawn:!0},{type:"stone",spawn:!0},{type:"stone",spawn:!0},{type:"stone",spawn:!0},{type:"grass",spawn:!1}],width:7},enemies:{maxAmount:10,minSpeed:.015,maxSpeed:.045,spawnPerFrames:48},bonuses:{maxAmount:2,spawnPerFrames:900,minTimer:3e3,maxTimer:5e3,types:[D]}};new(function(){function e(t){var n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Y(this,e),this.canvas=t,this.options=C({},A,{},r),this.level=new d(this.options.level),this.player=new g(this.options.player),this.enemies=[],this.bonuses=[],this.goals=[{expectingY:0,playerPos:{x:Math.floor(this.level.width/2),y:this.level.height-1}},{expectingY:this.level.height-1,playerPos:{x:Math.floor(this.level.width/2),y:0}}],this.canvas.width=101*this.level.width,this.canvas.height=101*this.level.height,this.ctx=t.getContext("2d"),this.paused=!1,this.score=0,M.then((function(e){n.assets=e,n.loop(),n.initEventListeners()})).catch(console.error)}var t,n,r;return t=e,(n=[{key:"pause",value:function(){this.paused=!0}},{key:"play",value:function(){this.paused=!1}},{key:"clearField",value:function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"readyForNewEnemy",value:function(){var e=this.options.enemies,t=e.maxAmount,n=e.spawnPerFrames;return t>this.enemies.length&&y(n)}},{key:"getEnemySpeed",value:function(){var e=this.options.enemies,t=e.minSpeed,n=e.maxSpeed;return f(1e3*t,1e3*n)/1e3}},{key:"renderEnemies",value:function(e,t){var n=this;this.readyForNewEnemy()&&this.enemies.push(new k(this.level.getSpawnY(),this.getEnemySpeed())),this.enemies=this.enemies.filter((function(e){return e.x<n.level.width})),this.enemies.forEach((function(n){return n.render(e,t)}))}},{key:"checkCollisions",value:function(){var e=this.player,t=e.x,n=e.y;this.enemies.some((function(e){return Math.round(e.x)===t&&e.y===n}))&&this.collapsePlayer()}},{key:"collapsePlayer",value:function(){this.player.collapse(this.options.player.position),this.player.hp<1&&(this.paused=!0,console.log("You scored ".concat(this.score,". Way to go!")))}},{key:"readyForNewBonus",value:function(){var e=this.options.bonuses,t=e.maxAmount,n=e.spawnPerFrames;return t>this.bonuses.length&&y(n)}},{key:"renderBonuses",value:function(e,t){if(this.readyForNewBonus()){var n=this.level.getSpawnPos(),r=n.x,i=n.y,o=this.options.bonuses,s=o.minTimer,a=o.maxTimer,c=o.types;this.bonuses.push(new(c[f(c.length)])(r,i,f(s,a)))}this.bonuses=this.bonuses.filter((function(e){return e.available})),this.bonuses.forEach((function(n){return n.render(e[n.imgTag],t)}))}},{key:"checkPickUps",value:function(){var e=this,t=this.player,n=t.x,r=t.y;this.bonuses.forEach((function(t){t.x===n&&t.y===r&&t.pickUp(e)}))}},{key:"applyGoals",value:function(){this.player.y===this.goals[0].expectingY&&(this.goals.push(this.goals.shift()),this.options.player.position=this.goals[0].playerPos,this.evolve(),this.score+=10,console.log("Current score is ".concat(this.score,". Now go back to ").concat(this.level.map[this.goals[0].expectingY].type)))}},{key:"evolve",value:function(){this.options.enemies.maxAmount+=.25,this.options.enemies.minSpeed+=.002,this.options.enemies.maxSpeed+=.002,this.options.enemies.spawnPerFrames-=2,this.options.bonuses.minTimer+=100,this.options.bonuses.maxTimer+=100}},{key:"renderHpBar",value:function(){for(var e=(this.canvas.width-30*this.player.hp)/2,t=0;t<this.player.hp;t++)this.ctx.drawImage(this.assets.heart,e+30*t,-10,30,51)}},{key:"loop",value:function(){var e=this;this.clearField(),this.level.render(this.assets,this.ctx),this.renderEnemies(this.assets.enemy,this.ctx),this.renderBonuses(this.assets,this.ctx),this.player.render(this.assets.player,this.ctx),this.checkCollisions(),this.checkPickUps(),this.applyGoals(),this.renderHpBar(),this.paused||requestAnimationFrame((function(){return e.loop()}))}},{key:"initEventListeners",value:function(){var e=this;document.addEventListener("keydown",(function(t){if(!e.paused){var n=e.player,r=e.level,i=r.width,o=r.height;switch(t.keyCode){case 37:case 65:n.x>0&&n.moveLeft();break;case 38:case 87:n.y>0&&n.moveUp();break;case 39:case 68:n.x<i-1&&n.moveRight();break;case 40:n.y<o-1&&n.moveDown()}}}))}}])&&_(t.prototype,n),r&&_(t,r),e}())(document.querySelector(".game-field"))}},[["tjUo",1]]]);